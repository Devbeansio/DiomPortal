{"ast":null,"code":"import _slicedToArray from\"D:/diom working project/staging/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from\"react\";import{useSnackbar}from\"notistack\";import{usePaginatedQuery}from\"../../hooks/query\";import{getNewreports,getPastreports}from\"../../APIS/reports\";import{QueryClient,useQueryClient}from\"react-query\";import{DIOM_BASED_URLS}from\"../../config/url\";import{toast}from\"react-toastify\";var useReportRequest=function useReportRequest(){var _useSnackbar=useSnackbar(),enqueueSnackbar=_useSnackbar.enqueueSnackbar;var token=localStorage.getItem(\"Token\");var _useState=useState(1),_useState2=_slicedToArray(_useState,2),currentPage=_useState2[0],setCurrentPage=_useState2[1];var _useState3=useState(50),_useState4=_slicedToArray(_useState3,2),pageSize=_useState4[0],setPageSize=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isOpen=_useState6[0],setIsOpen=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),newOldReportsData=_useState8[0],setNewOldReportsData=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),postFilter=_useState10[0],setPostFilter=_useState10[1];var _useState11=useState(\"USER_REPORTS\"),_useState12=_slicedToArray(_useState11,2),selectedReportType=_useState12[0],setSelectedReportType=_useState12[1];var _useState13=useState(\"1\"),_useState14=_slicedToArray(_useState13,2),activeTabJustify=_useState14[0],setActiveTabJustify=_useState14[1];var QueryClient=useQueryClient();var changeCurrentPage=function changeCurrentPage(pageNum){setCurrentPage(pageNum);// QueryClient.invalidateQueries(\"newReportssData\");\n};var reportTypeOptions=[{label:\"Booking Report\",value:\"BOOKING_REPORTS\"},{label:\"User Report\",value:\"USER_REPORTS\"},{label:\"User Ananlysis Report\",value:\"USER_ANALYSIS_REPORTS\"},{label:\"Cancelled Bookings\",value:\"CANCELLED_BOOKINGS_REPORTS\"}];var retryFunc=function retryFunc(){var message=\"Gathering Report Data\";enqueueSnackbar(message,{variant:\"success\"});};var pagelengthnum=function pagelengthnum(e){if(e.target.value===\"1\"){setPageSize(10);// QueryClient.invalidateQueries(\"newReportssData\");\n}else if(e.target.value===\"2\"){setPageSize(30);// QueryClient.invalidateQueries(\"newReportssData\");\n}else if(e.target.value===\"3\"){setPageSize(50);}};// useEffect(() => {\n//   (async () => {\n//     getPastreports(token, selectedReportType, postFilter,pageSize,currentPage);\n//     getNewreports(token, selectedReportType, postFilter,pageSize,currentPage)\n//     // resourceResourcetypesdata && (await getresoucresbyid());\n//   })();\n// }, [\n//   pageSize,currentPage\n// ]);\nvar toggle=function toggle(){setIsOpen(!isOpen);};var downloadFunc=function downloadFunc(rowId){var message1=\"Your Report has started  to download\";enqueueSnackbar(message1,{variant:\"success\"});fetch(\"\".concat(DIOM_BASED_URLS,\"/reports/commands\"),{method:\"POST\",headers:{Accept:\"application/json, text/plain\",\"Content-Type\":\"application/json;charset=UTF-8\",Authorization:\"Bearer \"+token},body:JSON.stringify({id:\"\".concat(rowId),command:\"MARK_READ\"})}).then(function(result3){}).catch(function(error){return toast.error(\" Something went wrong\");});};var reportTyperequestFunc=function reportTyperequestFunc(e){setPostFilter(true);setSelectedReportType(e.value);};// *************\nvar _usePaginatedQuery=usePaginatedQuery([\"pastReprtssData\",\"\".concat(selectedReportType,\", \").concat(pageSize,\",\").concat(currentPage)],function(){return getPastreports(token,selectedReportType,postFilter,pageSize,currentPage);}),_usePaginatedQuery$da=_usePaginatedQuery.data,pastReportsDataa=_usePaginatedQuery$da.data,pastHasNextPage=_usePaginatedQuery$da.hasNextPage,pastHasPreviousPage=_usePaginatedQuery$da.hasPreviousPage,pastTotal=_usePaginatedQuery$da.total,pastReportsRefteh=_usePaginatedQuery$da.refetch,isLoading=_usePaginatedQuery.isLoading;// *************\n// *************\nvar _usePaginatedQuery2=usePaginatedQuery([\"newReportssData\",,\"\".concat(selectedReportType,\",\").concat(pageSize,\",\").concat(currentPage)],function(){return getNewreports(token,selectedReportType,postFilter,pageSize,currentPage);}),_usePaginatedQuery2$d=_usePaginatedQuery2.data,newReportsDataa=_usePaginatedQuery2$d.data,newHasNextPage=_usePaginatedQuery2$d.hasNextPage,newHasPreviousPage=_usePaginatedQuery2$d.hasPreviousPage,newTotal=_usePaginatedQuery2$d.total,newReportsRefteh=_usePaginatedQuery2$d.refetch;var pageOptions={sizePerPage:pageSize,totalSize:activeTabJustify===\"1\"?pastTotal:activeTabJustify===\"2\"?newTotal:pastTotal!==null&&pastTotal!==void 0?pastTotal:0,custom:true};return{reportTypeOptions:reportTypeOptions,retryFunc:retryFunc,downloadFunc:downloadFunc,pastReportsDataa:pastReportsDataa,newReportsDataa:newReportsDataa,newOldReportsData:newOldReportsData,setNewOldReportsData:setNewOldReportsData,isLoading:isLoading,reportTyperequestFunc:reportTyperequestFunc,pastHasNextPage:pastHasNextPage,pastTotal:pastTotal,pastHasPreviousPage:pastHasPreviousPage,pastReportsRefteh:pastReportsRefteh,newHasNextPage:newHasNextPage,newHasPreviousPage:newHasPreviousPage,newTotal:newTotal,newReportsRefteh:newReportsRefteh,pagelengthnum:pagelengthnum,toggle:toggle,isOpen:isOpen,pageSize:pageSize,currentPage:currentPage,changeCurrentPage:changeCurrentPage,pageOptions:pageOptions,activeTabJustify:activeTabJustify,setActiveTabJustify:setActiveTabJustify};};export default useReportRequest;","map":{"version":3,"sources":["D:/diom working project/staging/src/pages/Reports/useReportRequest.js"],"names":["React","useState","useEffect","useSnackbar","usePaginatedQuery","getNewreports","getPastreports","QueryClient","useQueryClient","DIOM_BASED_URLS","toast","useReportRequest","enqueueSnackbar","token","localStorage","getItem","currentPage","setCurrentPage","pageSize","setPageSize","isOpen","setIsOpen","newOldReportsData","setNewOldReportsData","postFilter","setPostFilter","selectedReportType","setSelectedReportType","activeTabJustify","setActiveTabJustify","changeCurrentPage","pageNum","reportTypeOptions","label","value","retryFunc","message","variant","pagelengthnum","e","target","toggle","downloadFunc","rowId","message1","fetch","method","headers","Accept","Authorization","body","JSON","stringify","id","command","then","result3","catch","error","reportTyperequestFunc","data","pastReportsDataa","pastHasNextPage","hasNextPage","pastHasPreviousPage","hasPreviousPage","pastTotal","total","pastReportsRefteh","refetch","isLoading","newReportsDataa","newHasNextPage","newHasPreviousPage","newTotal","newReportsRefteh","pageOptions","sizePerPage","totalSize","custom"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useSnackbar } from \"notistack\";\r\nimport { usePaginatedQuery } from \"../../hooks/query\";\r\nimport { getNewreports, getPastreports } from \"../../APIS/reports\";\r\nimport { QueryClient ,useQueryClient} from \"react-query\";\r\nimport { DIOM_BASED_URLS } from \"../../config/url\";\r\nimport { toast } from \"react-toastify\";\r\n\r\nconst useReportRequest = () => {\r\n \r\n  const { enqueueSnackbar } = useSnackbar();\r\n  const token = localStorage.getItem(\"Token\");\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [pageSize, setPageSize] = useState(50);\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const [newOldReportsData, setNewOldReportsData] = useState([]);\r\n  const [postFilter, setPostFilter] = useState(false);\r\n  const [selectedReportType, setSelectedReportType] = useState(\"USER_REPORTS\");\r\n  const [activeTabJustify, setActiveTabJustify] = useState(\"1\");\r\n   const QueryClient = useQueryClient();\r\n\r\n\r\n\r\n  const changeCurrentPage = (pageNum) => {\r\n    setCurrentPage(pageNum);\r\n    // QueryClient.invalidateQueries(\"newReportssData\");\r\n  };\r\n  const reportTypeOptions = [\r\n    { label: \"Booking Report\", value: \"BOOKING_REPORTS\" },\r\n    { label: \"User Report\", value: \"USER_REPORTS\" },\r\n    { label: \"User Ananlysis Report\", value: \"USER_ANALYSIS_REPORTS\" },\r\n    { label: \"Cancelled Bookings\", value: \"CANCELLED_BOOKINGS_REPORTS\" },\r\n  ];\r\n\r\n  const retryFunc = () => {\r\n    const message = \"Gathering Report Data\";\r\n    enqueueSnackbar(message, {\r\n      variant: \"success\",\r\n    });\r\n  };\r\n\r\n \r\n\r\n  const pagelengthnum = (e) => {\r\n    \r\n    if (e.target.value === \"1\") {\r\n      setPageSize(10);\r\n      // QueryClient.invalidateQueries(\"newReportssData\");\r\n    } else if (e.target.value === \"2\") {\r\n      setPageSize(30);\r\n      // QueryClient.invalidateQueries(\"newReportssData\");\r\n    } else if (e.target.value === \"3\") {\r\n      setPageSize(50);\r\n    }\r\n  };\r\n\r\n  // useEffect(() => {\r\n  //   (async () => {\r\n  //     getPastreports(token, selectedReportType, postFilter,pageSize,currentPage);\r\n  //     getNewreports(token, selectedReportType, postFilter,pageSize,currentPage)\r\n\r\n     \r\n  //     // resourceResourcetypesdata && (await getresoucresbyid());\r\n  //   })();\r\n  // }, [\r\n  //   pageSize,currentPage\r\n  // ]);\r\n\r\n  const toggle = () => {\r\n    setIsOpen(!isOpen);\r\n  };\r\n\r\n  const downloadFunc = (rowId) => {\r\n    const message1 = \"Your Report has started  to download\";\r\n    enqueueSnackbar(message1, {\r\n      variant: \"success\",\r\n    });\r\n    fetch(`${DIOM_BASED_URLS}/reports/commands`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        Accept: \"application/json, text/plain\",\r\n        \"Content-Type\": \"application/json;charset=UTF-8\",\r\n        Authorization: \"Bearer \" + token,\r\n      },\r\n      body: JSON.stringify({\r\n        id: `${rowId}`,\r\n        command: \"MARK_READ\",\r\n      }),\r\n    })\r\n      .then((result3) => {})\r\n      .catch((error) => toast.error(\" Something went wrong\"));\r\n  };\r\n\r\n  const reportTyperequestFunc = (e) => {\r\n    setPostFilter(true);\r\n    setSelectedReportType(e.value);\r\n  };\r\n\r\n  // *************\r\n\r\n  const {\r\n    data: {\r\n      data: pastReportsDataa,\r\n      hasNextPage: pastHasNextPage,\r\n      hasPreviousPage: pastHasPreviousPage,\r\n      total: pastTotal,\r\n      refetch: pastReportsRefteh,\r\n      \r\n    },\r\n    isLoading,\r\n  } = usePaginatedQuery([\"pastReprtssData\", `${selectedReportType}, ${pageSize},${currentPage}`], () =>\r\n    getPastreports(token, selectedReportType, postFilter,pageSize,currentPage)\r\n  );\r\n  // *************\r\n  // *************\r\n  const {\r\n    data: {\r\n      data: newReportsDataa,\r\n      hasNextPage: newHasNextPage,\r\n      hasPreviousPage: newHasPreviousPage,\r\n      total: newTotal,\r\n      refetch: newReportsRefteh,\r\n    },\r\n  } = usePaginatedQuery([\"newReportssData\", , `${selectedReportType},${pageSize},${currentPage}`], () =>\r\n    getNewreports(token, selectedReportType, postFilter,pageSize,currentPage)\r\n  );\r\n\r\n\r\n  const pageOptions = {\r\n    sizePerPage: pageSize,\r\n    totalSize: activeTabJustify ===\"1\"?pastTotal :activeTabJustify ===\"2\"?newTotal:pastTotal  ?? 0,\r\n    custom: true,\r\n  };\r\n\r\n\r\n  return {\r\n    reportTypeOptions,\r\n    retryFunc,\r\n    downloadFunc,\r\n    pastReportsDataa,\r\n    newReportsDataa,\r\n    newOldReportsData,\r\n    setNewOldReportsData,\r\n    isLoading,\r\n    reportTyperequestFunc,\r\n    pastHasNextPage,\r\n    pastTotal,\r\n    pastHasPreviousPage,\r\n    pastReportsRefteh,\r\n    newHasNextPage,\r\n    newHasPreviousPage,\r\n    newTotal,\r\n    newReportsRefteh,\r\n    pagelengthnum,\r\n    toggle,\r\n    isOpen,\r\n    pageSize,\r\n    currentPage,\r\n    changeCurrentPage,\r\n    pageOptions,\r\n    activeTabJustify, setActiveTabJustify\r\n    \r\n  };\r\n};\r\n\r\nexport default useReportRequest;\r\n"]},"metadata":{},"sourceType":"module"}