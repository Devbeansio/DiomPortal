{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/tech sign/Desktop/1diom-frontend/diom-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/tech sign/Desktop/1diom-frontend/diom-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\tech sign\\\\Desktop\\\\1diom-frontend\\\\diom-frontend\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{useEffect,useState}from\"react\";import{QueryClient,useQuery,useQueryClient}from\"react-query\";import{getResources,getLocations,getSearchedResources}from\"../../APIS\";import{useAllDataQuery,usePaginatedQuery}from\"../../hooks/query\";export var useInventories=function useInventories(){var _data$total;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isOpen=_useState2[0],setIsOpen=_useState2[1];var token=localStorage.getItem(\"Token\");var _useState3=useState(1),_useState4=_slicedToArray(_useState3,2),currentPage=_useState4[0],setCurrentPage=_useState4[1];var _useState5=useState(50),_useState6=_slicedToArray(_useState5,2),pageSize=_useState6[0],setPageSize=_useState6[1];var changeCurrentPage=function changeCurrentPage(pageNum){return setCurrentPage(pageNum);};var queryClient=useQueryClient();var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),applyLocationFilter=_useState8[0],setApplyFilter=_useState8[1];var _useState9=useState(\"All\"),_useState10=_slicedToArray(_useState9,2),filter=_useState10[0],setFilter=_useState10[1];// const {\n//   data: { data: resourcesData, hasNextPage, hasPreviousPage, total },\n//   isLoading,\n// } = usePaginatedQuery([\"resources\", currentPage, filter], () =>\n//   getResources(pageSize, currentPage, token, applyLocationFilter, filter)\n// );\nconsole.log(\"total\",\"total\");console.log([\"resources\",currentPage,filter]);var _useQuery=useQuery([\"resources\",currentPage,filter],/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return getResources(pageSize,currentPage,token,applyLocationFilter,filter);case 2:return _context.abrupt(\"return\",_context.sent);case 3:case\"end\":return _context.stop();}}},_callee);})),{keepPreviousData:true,staleTime:2000,retry:false}),data=_useQuery.data,isLoading=_useQuery.isLoading;console.log(\"total\",\"total\");console.log(data===null||data===void 0?void 0:data.total,\"total\");// usePaginatedQuery(,\n// );\nvar _usePaginatedQuery=usePaginatedQuery([\"searcehdresources\"],function(){return getSearchedResources(token);}),resourcessearchedData=_usePaginatedQuery.data.data;var _useAllDataQuery=useAllDataQuery([\"locations\",\"visible\"],function(){return getLocations(token);}),locationsData=_useAllDataQuery.data,loadingLocations=_useAllDataQuery.isLoading;var toggle=function toggle(){setIsOpen(!isOpen);};var pagelengthnum=function pagelengthnum(e){if(e.target.value===\"1\"){setPageSize(10);}else if(e.target.value===\"2\"){setPageSize(30);}else if(e.target.value===\"3\"){setPageSize(50);}// QueryClient.invalidateQueries(\"searcehdresources\");\n};var pageOptions={sizePerPage:pageSize,totalSize:(_data$total=data===null||data===void 0?void 0:data.total)!==null&&_data$total!==void 0?_data$total:0,custom:true};var onChangeLocationFilter=function onChangeLocationFilter(val){if(val===\"All\"){setCurrentPage(currentPage);setApplyFilter(false);setFilter(\"All\");}else{setCurrentPage(currentPage);setApplyFilter(true);setFilter(\"{\\\"BusinessId\\\":\".concat(val,\"}\"));}};useEffect(function(){// FOR PRE-FETCHING NEXT PAGE\nif(data!==null&&data!==void 0&&data.hasNextPage){var nextPage=currentPage+1;console.log(\"dkakhdkjs dhakjs\",[\"resources\",nextPage,filter]);queryClient.prefetchQuery([\"resources\",nextPage,filter],/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return getResources(pageSize,nextPage,token);case 2:return _context2.abrupt(\"return\",_context2.sent);case 3:case\"end\":return _context2.stop();}}},_callee2);})));}},[currentPage,filter]);return{currentPage:currentPage,pageOptions:pageOptions,resourcesData:data===null||data===void 0?void 0:data.data,hasNextPage:data===null||data===void 0?void 0:data.hasNextPage,hasPreviousPage:data===null||data===void 0?void 0:data.hasPreviousPage,total:data===null||data===void 0?void 0:data.total,locationsData:locationsData,loadingLocations:loadingLocations,isLoading:isLoading,onChangeLocationFilter:onChangeLocationFilter,changeCurrentPage:changeCurrentPage,pagelengthnum:pagelengthnum,pageSize:pageSize,toggle:toggle,isOpen:isOpen,filter:filter// resourcessearchedData,\n};};","map":{"version":3,"sources":["C:/Users/tech sign/Desktop/1diom-frontend/diom-frontend/src/pages/Inventories/useInventories.js"],"names":["useEffect","useState","QueryClient","useQuery","useQueryClient","getResources","getLocations","getSearchedResources","useAllDataQuery","usePaginatedQuery","useInventories","isOpen","setIsOpen","token","localStorage","getItem","currentPage","setCurrentPage","pageSize","setPageSize","changeCurrentPage","pageNum","queryClient","applyLocationFilter","setApplyFilter","filter","setFilter","console","log","keepPreviousData","staleTime","retry","data","isLoading","total","resourcessearchedData","locationsData","loadingLocations","toggle","pagelengthnum","e","target","value","pageOptions","sizePerPage","totalSize","custom","onChangeLocationFilter","val","hasNextPage","nextPage","prefetchQuery","resourcesData","hasPreviousPage"],"mappings":"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","sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { QueryClient, useQuery, useQueryClient } from \"react-query\";\r\nimport { getResources, getLocations, getSearchedResources } from \"../../APIS\";\r\nimport { useAllDataQuery, usePaginatedQuery } from \"../../hooks/query\";\r\nexport const useInventories = () => {\r\n  const [isOpen, setIsOpen] = useState(false);\r\n  const token = localStorage.getItem(\"Token\");\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [pageSize, setPageSize] = useState(50);\r\n  const changeCurrentPage = (pageNum) => setCurrentPage(pageNum);\r\n  const queryClient = useQueryClient();\r\n  const [applyLocationFilter, setApplyFilter] = useState(false);\r\n  const [filter, setFilter] = useState(\"All\");\r\n  // const {\r\n  //   data: { data: resourcesData, hasNextPage, hasPreviousPage, total },\r\n  //   isLoading,\r\n  // } = usePaginatedQuery([\"resources\", currentPage, filter], () =>\r\n  //   getResources(pageSize, currentPage, token, applyLocationFilter, filter)\r\n  // );\r\n  console.log(\"total\", \"total\");\r\n  console.log([\"resources\", currentPage, filter]);\r\n  const { data, isLoading } = useQuery(\r\n    [\"resources\", currentPage, filter],\r\n    async () =>\r\n      await getResources(\r\n        pageSize,\r\n        currentPage,\r\n        token,\r\n        applyLocationFilter,\r\n        filter\r\n      ),\r\n    {\r\n      keepPreviousData: true,\r\n      staleTime: 2000,\r\n      retry: false,\r\n    }\r\n  );\r\n  console.log(\"total\", \"total\");\r\n  console.log(data?.total, \"total\");\r\n\r\n  // usePaginatedQuery(,\r\n  // );\r\n\r\n  const {\r\n    data: { data: resourcessearchedData },\r\n  } = usePaginatedQuery([\"searcehdresources\"], () =>\r\n    getSearchedResources(token)\r\n  );\r\n\r\n  const { data: locationsData, isLoading: loadingLocations } = useAllDataQuery(\r\n    [\"locations\", \"visible\"],\r\n    () => getLocations(token)\r\n  );\r\n\r\n  const toggle = () => {\r\n    setIsOpen(!isOpen);\r\n  };\r\n  const pagelengthnum = (e) => {\r\n    if (e.target.value === \"1\") {\r\n      setPageSize(10);\r\n    } else if (e.target.value === \"2\") {\r\n      setPageSize(30);\r\n    } else if (e.target.value === \"3\") {\r\n      setPageSize(50);\r\n    }\r\n    // QueryClient.invalidateQueries(\"searcehdresources\");\r\n  };\r\n\r\n  const pageOptions = {\r\n    sizePerPage: pageSize,\r\n    totalSize: data?.total ?? 0,\r\n    custom: true,\r\n  };\r\n  const onChangeLocationFilter = (val) => {\r\n    if (val === \"All\") {\r\n      setCurrentPage(currentPage);\r\n      setApplyFilter(false);\r\n      setFilter(\"All\");\r\n    } else {\r\n      setCurrentPage(currentPage);\r\n      setApplyFilter(true);\r\n      setFilter(`{\"BusinessId\":${val}}`);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    // FOR PRE-FETCHING NEXT PAGE\r\n    if (data?.hasNextPage) {\r\n      const nextPage = currentPage + 1;\r\n      console.log(\"dkakhdkjs dhakjs\", [\"resources\", nextPage, filter]);\r\n      queryClient.prefetchQuery(\r\n        [\"resources\", nextPage, filter],\r\n        async () => await getResources(pageSize, nextPage, token)\r\n      );\r\n    }\r\n  }, [currentPage, filter]);\r\n\r\n  return {\r\n    currentPage,\r\n    pageOptions,\r\n    resourcesData: data?.data,\r\n    hasNextPage: data?.hasNextPage,\r\n    hasPreviousPage: data?.hasPreviousPage,\r\n    total: data?.total,\r\n    locationsData,\r\n    loadingLocations,\r\n    isLoading,\r\n    onChangeLocationFilter,\r\n    changeCurrentPage,\r\n    pagelengthnum,\r\n    pageSize,\r\n    toggle,\r\n    isOpen,\r\n    filter,\r\n    // resourcessearchedData,\r\n  };\r\n};\r\n"]},"metadata":{},"sourceType":"module"}