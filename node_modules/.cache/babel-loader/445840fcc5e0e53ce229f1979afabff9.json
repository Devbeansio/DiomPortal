{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport { useQueryClient, useQuery } from \"react-query\";\nimport { getLocations } from \"../../APIS\";\nimport { getreportLocationBrand, // getreportLocations,\ngetResourcetypereports } from \"../../APIS/reports\";\nimport { getUserByProfession } from \"../../APIS/userProfle\";\nimport { DIOM_BASED_URLS } from \"../../config/url\";\nimport { useAllDataQuery } from \"../../hooks/query\";\n\nconst UseReports = () => {\n  _s();\n\n  const token = localStorage.getItem(\"Token\");\n  const queryClient = useQueryClient();\n  const [reportFinalValues, setreportFinalValues] = useState({});\n  const [reportFinalLabels, setReportFinalLabels] = useState({});\n  const [categoryDropDown, setCategoryDropDown] = useState([]);\n  const [locationApplyFilter, setLocationApplyFilter] = useState(false);\n  const [resourcetypeApplyFilter, setResourcetypeApplyFilter] = useState(false);\n  const reportTypeOptions = [{\n    label: \"Booking Report\",\n    value: 0\n  }, {\n    label: \"User Report\",\n    value: 1\n  }, {\n    label: \"User Ananlysis Report\",\n    value: 2\n  }, {\n    label: \"Cancelled Bookings\",\n    value: 3\n  }];\n  const timeSlotOptions = [{\n    label: \"08_AM-04_PM\",\n    value: 0\n  }, {\n    label: \"04_PM-12_AM\",\n    value: 1\n  }, {\n    label: \"12_AM-08_AM\",\n    value: 2\n  }];\n\n  const getreportLocations = async (token, locationApplyFilter, reportFinalValues, locationInvalidatequerry) => {\n    // console.log(\"locationApplyFilter====>  \", locationApplyFilter);\n    // console.log(\n    //   \"reportFinalValues ====^^^ : \",\n    //   JSON.stringify(reportFinalValues?.diomBrand)\n    // );\n    const diomBrandValue = JSON.stringify(reportFinalValues === null || reportFinalValues === void 0 ? void 0 : reportFinalValues.diomBrand);\n    const res = (await (await fetch(!locationApplyFilter || diomBrandValue == [] ? `${DIOM_BASED_URLS}/admin-business-locations?filter={\"where\":{\"visibility\":true}}` : `${DIOM_BASED_URLS}/admin-business-locations?filter={\"where\":{\"locationCategoriesId\":{\"inq\":${diomBrandValue}}}}`, {\n      method: \"GET\",\n      redirect: \"follow\",\n      headers: {\n        Authorization: \"Bearer \" + token\n      }\n    })).json()).map(element => ({\n      value: element.id,\n      label: element.Name\n    }));\n    return [{\n      label: \"--All Locations\",\n      options: [...res]\n    }];\n    queryClient.setQueryData(\"locationsreports1\");\n  };\n\n  const reportTypeHandeler = e => {\n    // console.log(\"reportTypeHandeler : \", e);\n    setreportFinalValues({ ...reportFinalValues,\n      reportType: e\n    });\n    setReportFinalLabels({ ...reportFinalLabels,\n      reportType: e\n    });\n  };\n\n  const timeSlotHandler = e => {\n    const timeSlotLabel = e.map(element => {\n      return element.label;\n    }); // const timeSlotValue = e.map((element) => {\n    //   return element.value;\n    // });\n\n    setreportFinalValues({ ...reportFinalValues,\n      timeSlot: timeSlotLabel\n    });\n    setReportFinalLabels({ ...reportFinalLabels,\n      timeSlot: timeSlotLabel\n    });\n  };\n\n  const diomBrandHandler = async e => {\n    // console.log(\"reportFinalValues?.diomBrand :\", reportFinalValues?.diomBrand);\n    const brandValue = e.map(element => {\n      return element.value;\n    });\n    const brandLabel = e.map(element => {\n      return element.label;\n    });\n    setreportFinalValues({ ...reportFinalValues,\n      diomBrand: brandValue\n    });\n    setReportFinalLabels({ ...reportFinalLabels,\n      diomBrand: brandLabel\n    });\n    setLocationApplyFilter(true); // await queryClient.setQueryData(\"locationsreports1\");\n  };\n\n  const diomLocationHandler = e => {\n    const locationValue = e.map(element => {\n      return element.value;\n    });\n    const locationLabel = e.map(element => {\n      return element.label;\n    });\n    setreportFinalValues({ ...reportFinalValues,\n      diomLocations: locationValue\n    });\n    setReportFinalLabels({ ...reportFinalLabels,\n      diomLocations: locationLabel\n    });\n    setResourcetypeApplyFilter(true);\n    queryClient.invalidateQueries(\"resourceTypedropdownreports\");\n  };\n\n  const resourceTypeHandler = e => {\n    const resourceTypeValue = e.map(element => {\n      return element.value;\n    });\n    const resourceTypeLabel = e.map(element => {\n      return element.label;\n    });\n    setreportFinalValues({ ...reportFinalValues,\n      resourceTypes: resourceTypeValue\n    });\n    setReportFinalLabels({ ...reportFinalLabels,\n      resourceTypes: resourceTypeLabel\n    });\n  };\n\n  const userTypeIndustryHandler = e => {\n    const userTypeIndustryValue = e.map(element => {\n      return element.value;\n    });\n    const userTypeIndustryLabel = e.map(element => {\n      return element.label;\n    });\n    setreportFinalValues({ ...reportFinalValues,\n      userTypeByIndustry: userTypeIndustryValue\n    });\n    setReportFinalLabels({ ...reportFinalLabels,\n      userTypeByIndustry: userTypeIndustryLabel\n    });\n  };\n\n  const userTypePositionHandler = e => {\n    const userTypePositionValue = e.map(element => {\n      return element.value;\n    });\n    const userTypePositionLabel = e.map(element => {\n      return element.label;\n    });\n    setreportFinalValues({ ...reportFinalValues,\n      userTypeByPosition: userTypePositionValue\n    });\n    setReportFinalLabels({ ...reportFinalLabels,\n      userTypeByPosition: userTypePositionLabel\n    });\n  };\n\n  const startdateFunc = e => {\n    const starttdate = e.target.value;\n    const startdate = new Date(starttdate).toISOString();\n    setreportFinalValues({ ...reportFinalValues,\n      startDate: startdate\n    });\n    setReportFinalLabels({ ...reportFinalLabels,\n      startDate: startdate\n    });\n  };\n\n  const endDateFunc = e => {\n    const endddate = e.target.value;\n    const enddate = new Date(endddate).toISOString();\n    setreportFinalValues({ ...reportFinalValues,\n      endDate: enddate\n    });\n    setReportFinalLabels({ ...reportFinalLabels,\n      endDate: enddate\n    });\n  }; // ***************\n  // const { data: locationsData, isLoading: loadingLocations } = useAllDataQuery(\n\n\n  const {\n    data: locationData\n  } = useQuery([\"locationsreports1\"], () => getreportLocations(token, locationApplyFilter, reportFinalValues)); // const locationData = locationsData;\n  // *******************\n\n  const {\n    data: brandData\n  } = useAllDataQuery([\"reportlocationbrandData\", \"visible\"], () => getreportLocationBrand(token)); // *************\n\n  const resourceTypedropdownData = useQuery([\"resourceTypedropdownreports\"], () => getResourcetypereports(token, resourcetypeApplyFilter, reportFinalValues));\n  const resourceTypedropdownDailedData = resourceTypedropdownData.data; // *************\n\n  const Resourcetypesdropdown = async () => {\n    const matadata = resourceTypedropdownDailedData.data.map(element => {\n      return {\n        label: element.Name,\n        value: element.id,\n        UniqueId: element.UniqueId,\n        resourceTypeCategoryId: element.resourceTypeCategoryId // visibility: element.visibility,\n\n      };\n    });\n    setCategoryDropDown(matadata);\n  }; // **************\n\n\n  const userByProfession = useQuery([\"getuserbyprofession\"], () => getUserByProfession(token));\n  const userByProfessionData = userByProfession.data;\n  const userByProfessionDataa = userByProfessionData === null || userByProfessionData === void 0 ? void 0 : userByProfessionData.data; // console.log(\"userByProfessionData \", userByProfessionDataa);\n\n  const userbyprofessionindustry = userByProfessionDataa === null || userByProfessionDataa === void 0 ? void 0 : userByProfessionDataa.industries.map((element, index) => ({\n    value: element.id,\n    label: element.name\n  })); // console.log(\"userbyprofessionindustry \", userbyprofessionindustry);\n\n  const userbyprofessionPosition = userByProfessionDataa === null || userByProfessionDataa === void 0 ? void 0 : userByProfessionDataa.positions.map((element, index) => {\n    return {\n      //   ...element,\n      value: element.id,\n      label: element.name\n    };\n  }); // console.log(\"userbyprofessionPosition \", userbyprofessionPosition);\n  // *************\n\n  const reportExport = () => {\n    console.log(\"reportFinalIDs : \", reportFinalValues);\n    console.log(\"reportFinalLabels: \", reportFinalLabels);\n  }; // console.log(\"locationApplyFilter :\", locationApplyFilter);\n\n\n  useEffect( // FOR PRE-FETCHING NEXT PAGE\n  () => {\n    getreportLocations(token, locationApplyFilter, reportFinalValues);\n  }, [reportFinalValues, reportFinalValues]);\n  useEffect( // FOR PRE-FETCHING NEXT PAGE\n  async () => {\n    queryClient.invalidateQueries(\"locationsreports1\");\n    resourceTypedropdownDailedData && (await Resourcetypesdropdown());\n  }, [resourceTypedropdownDailedData, locationApplyFilter]);\n  return {\n    reportTypeOptions,\n    userByProfessionData,\n    userbyprofessionPosition,\n    userbyprofessionindustry,\n    timeSlotOptions,\n    locationData,\n    brandData,\n    reportTypeHandeler,\n    timeSlotHandler,\n    diomBrandHandler,\n    diomLocationHandler,\n    resourceTypeHandler,\n    userTypeIndustryHandler,\n    userTypePositionHandler,\n    startdateFunc,\n    endDateFunc,\n    reportExport,\n    categoryDropDown\n  };\n};\n\n_s(UseReports, \"McG/4bqYw2zDF1d2mFAJhcFUotc=\", false, function () {\n  return [useQueryClient, useQuery, useAllDataQuery, useQuery, useQuery];\n});\n\n_c = UseReports;\nexport default UseReports;\n\nvar _c;\n\n$RefreshReg$(_c, \"UseReports\");","map":{"version":3,"sources":["C:/Users/tech sign/Desktop/1diom-frontend/diom-frontend/src/pages/Reports/useReports.js"],"names":["React","useState","useEffect","useQueryClient","useQuery","getLocations","getreportLocationBrand","getResourcetypereports","getUserByProfession","DIOM_BASED_URLS","useAllDataQuery","UseReports","token","localStorage","getItem","queryClient","reportFinalValues","setreportFinalValues","reportFinalLabels","setReportFinalLabels","categoryDropDown","setCategoryDropDown","locationApplyFilter","setLocationApplyFilter","resourcetypeApplyFilter","setResourcetypeApplyFilter","reportTypeOptions","label","value","timeSlotOptions","getreportLocations","locationInvalidatequerry","diomBrandValue","JSON","stringify","diomBrand","res","fetch","method","redirect","headers","Authorization","json","map","element","id","Name","options","setQueryData","reportTypeHandeler","e","reportType","timeSlotHandler","timeSlotLabel","timeSlot","diomBrandHandler","brandValue","brandLabel","diomLocationHandler","locationValue","locationLabel","diomLocations","invalidateQueries","resourceTypeHandler","resourceTypeValue","resourceTypeLabel","resourceTypes","userTypeIndustryHandler","userTypeIndustryValue","userTypeIndustryLabel","userTypeByIndustry","userTypePositionHandler","userTypePositionValue","userTypePositionLabel","userTypeByPosition","startdateFunc","starttdate","target","startdate","Date","toISOString","startDate","endDateFunc","endddate","enddate","endDate","data","locationData","brandData","resourceTypedropdownData","resourceTypedropdownDailedData","Resourcetypesdropdown","matadata","UniqueId","resourceTypeCategoryId","userByProfession","userByProfessionData","userByProfessionDataa","userbyprofessionindustry","industries","index","name","userbyprofessionPosition","positions","reportExport","console","log"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,SAASC,cAAT,EAAyBC,QAAzB,QAAyC,aAAzC;AACA,SAASC,YAAT,QAA6B,YAA7B;AACA,SACEC,sBADF,EAEE;AACAC,sBAHF,QAIO,oBAJP;AAKA,SAASC,mBAAT,QAAoC,uBAApC;AACA,SAASC,eAAT,QAAgC,kBAAhC;AACA,SAASC,eAAT,QAAgC,mBAAhC;;AAEA,MAAMC,UAAU,GAAG,MAAM;AAAA;;AACvB,QAAMC,KAAK,GAAGC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAd;AACA,QAAMC,WAAW,GAAGZ,cAAc,EAAlC;AAEA,QAAM,CAACa,iBAAD,EAAoBC,oBAApB,IAA4ChB,QAAQ,CAAC,EAAD,CAA1D;AACA,QAAM,CAACiB,iBAAD,EAAoBC,oBAApB,IAA4ClB,QAAQ,CAAC,EAAD,CAA1D;AACA,QAAM,CAACmB,gBAAD,EAAmBC,mBAAnB,IAA0CpB,QAAQ,CAAC,EAAD,CAAxD;AACA,QAAM,CAACqB,mBAAD,EAAsBC,sBAAtB,IAAgDtB,QAAQ,CAAC,KAAD,CAA9D;AACA,QAAM,CAACuB,uBAAD,EAA0BC,0BAA1B,IAAwDxB,QAAQ,CAAC,KAAD,CAAtE;AAEA,QAAMyB,iBAAiB,GAAG,CACxB;AAAEC,IAAAA,KAAK,EAAE,gBAAT;AAA2BC,IAAAA,KAAK,EAAE;AAAlC,GADwB,EAExB;AAAED,IAAAA,KAAK,EAAE,aAAT;AAAwBC,IAAAA,KAAK,EAAE;AAA/B,GAFwB,EAGxB;AAAED,IAAAA,KAAK,EAAE,uBAAT;AAAkCC,IAAAA,KAAK,EAAE;AAAzC,GAHwB,EAIxB;AAAED,IAAAA,KAAK,EAAE,oBAAT;AAA+BC,IAAAA,KAAK,EAAE;AAAtC,GAJwB,CAA1B;AAMA,QAAMC,eAAe,GAAG,CACtB;AAAEF,IAAAA,KAAK,EAAE,aAAT;AAAwBC,IAAAA,KAAK,EAAE;AAA/B,GADsB,EAEtB;AAAED,IAAAA,KAAK,EAAE,aAAT;AAAwBC,IAAAA,KAAK,EAAE;AAA/B,GAFsB,EAGtB;AAAED,IAAAA,KAAK,EAAE,aAAT;AAAwBC,IAAAA,KAAK,EAAE;AAA/B,GAHsB,CAAxB;;AAMA,QAAME,kBAAkB,GAAG,OACzBlB,KADyB,EAEzBU,mBAFyB,EAGzBN,iBAHyB,EAIzBe,wBAJyB,KAKtB;AACH;AACA;AACA;AACA;AACA;AAEA,UAAMC,cAAc,GAAGC,IAAI,CAACC,SAAL,CAAelB,iBAAf,aAAeA,iBAAf,uBAAeA,iBAAiB,CAAEmB,SAAlC,CAAvB;AAEA,UAAMC,GAAG,GAAG,CACV,MAAM,CACJ,MAAMC,KAAK,CACT,CAACf,mBAAD,IAAwBU,cAAc,IAAI,EAA1C,GACK,GAAEvB,eAAgB,gEADvB,GAEK,GAAEA,eAAgB,4EAA2EuB,cAAe,KAHxG,EAIT;AACEM,MAAAA,MAAM,EAAE,KADV;AAEEC,MAAAA,QAAQ,EAAE,QAFZ;AAGEC,MAAAA,OAAO,EAAE;AACPC,QAAAA,aAAa,EAAE,YAAY7B;AADpB;AAHX,KAJS,CADP,EAaJ8B,IAbI,EADI,EAeVC,GAfU,CAeLC,OAAD,KAAc;AAClBhB,MAAAA,KAAK,EAAEgB,OAAO,CAACC,EADG;AAElBlB,MAAAA,KAAK,EAAEiB,OAAO,CAACE;AAFG,KAAd,CAfM,CAAZ;AAmBA,WAAO,CACL;AACEnB,MAAAA,KAAK,EAAE,iBADT;AAEEoB,MAAAA,OAAO,EAAE,CAAC,GAAGX,GAAJ;AAFX,KADK,CAAP;AAMArB,IAAAA,WAAW,CAACiC,YAAZ,CAAyB,mBAAzB;AACD,GAxCD;;AA0CA,QAAMC,kBAAkB,GAAIC,CAAD,IAAO;AAChC;AACAjC,IAAAA,oBAAoB,CAAC,EAAE,GAAGD,iBAAL;AAAwBmC,MAAAA,UAAU,EAAED;AAApC,KAAD,CAApB;AACA/B,IAAAA,oBAAoB,CAAC,EAAE,GAAGD,iBAAL;AAAwBiC,MAAAA,UAAU,EAAED;AAApC,KAAD,CAApB;AACD,GAJD;;AAKA,QAAME,eAAe,GAAIF,CAAD,IAAO;AAC7B,UAAMG,aAAa,GAAGH,CAAC,CAACP,GAAF,CAAOC,OAAD,IAAa;AACvC,aAAOA,OAAO,CAACjB,KAAf;AACD,KAFqB,CAAtB,CAD6B,CAI7B;AACA;AACA;;AACAV,IAAAA,oBAAoB,CAAC,EAAE,GAAGD,iBAAL;AAAwBsC,MAAAA,QAAQ,EAAED;AAAlC,KAAD,CAApB;AACAlC,IAAAA,oBAAoB,CAAC,EAAE,GAAGD,iBAAL;AAAwBoC,MAAAA,QAAQ,EAAED;AAAlC,KAAD,CAApB;AACD,GATD;;AAUA,QAAME,gBAAgB,GAAG,MAAOL,CAAP,IAAa;AACpC;AAEA,UAAMM,UAAU,GAAGN,CAAC,CAACP,GAAF,CAAOC,OAAD,IAAa;AACpC,aAAOA,OAAO,CAAChB,KAAf;AACD,KAFkB,CAAnB;AAGA,UAAM6B,UAAU,GAAGP,CAAC,CAACP,GAAF,CAAOC,OAAD,IAAa;AACpC,aAAOA,OAAO,CAACjB,KAAf;AACD,KAFkB,CAAnB;AAIAV,IAAAA,oBAAoB,CAAC,EAAE,GAAGD,iBAAL;AAAwBmB,MAAAA,SAAS,EAAEqB;AAAnC,KAAD,CAApB;AACArC,IAAAA,oBAAoB,CAAC,EAAE,GAAGD,iBAAL;AAAwBiB,MAAAA,SAAS,EAAEsB;AAAnC,KAAD,CAApB;AACAlC,IAAAA,sBAAsB,CAAC,IAAD,CAAtB,CAZoC,CAcpC;AACD,GAfD;;AAgBA,QAAMmC,mBAAmB,GAAIR,CAAD,IAAO;AACjC,UAAMS,aAAa,GAAGT,CAAC,CAACP,GAAF,CAAOC,OAAD,IAAa;AACvC,aAAOA,OAAO,CAAChB,KAAf;AACD,KAFqB,CAAtB;AAGA,UAAMgC,aAAa,GAAGV,CAAC,CAACP,GAAF,CAAOC,OAAD,IAAa;AACvC,aAAOA,OAAO,CAACjB,KAAf;AACD,KAFqB,CAAtB;AAGAV,IAAAA,oBAAoB,CAAC,EACnB,GAAGD,iBADgB;AAEnB6C,MAAAA,aAAa,EAAEF;AAFI,KAAD,CAApB;AAIAxC,IAAAA,oBAAoB,CAAC,EACnB,GAAGD,iBADgB;AAEnB2C,MAAAA,aAAa,EAAED;AAFI,KAAD,CAApB;AAIAnC,IAAAA,0BAA0B,CAAC,IAAD,CAA1B;AACAV,IAAAA,WAAW,CAAC+C,iBAAZ,CAA8B,6BAA9B;AACD,GAjBD;;AAkBA,QAAMC,mBAAmB,GAAIb,CAAD,IAAO;AACjC,UAAMc,iBAAiB,GAAGd,CAAC,CAACP,GAAF,CAAOC,OAAD,IAAa;AAC3C,aAAOA,OAAO,CAAChB,KAAf;AACD,KAFyB,CAA1B;AAGA,UAAMqC,iBAAiB,GAAGf,CAAC,CAACP,GAAF,CAAOC,OAAD,IAAa;AAC3C,aAAOA,OAAO,CAACjB,KAAf;AACD,KAFyB,CAA1B;AAGAV,IAAAA,oBAAoB,CAAC,EACnB,GAAGD,iBADgB;AAEnBkD,MAAAA,aAAa,EAAEF;AAFI,KAAD,CAApB;AAIA7C,IAAAA,oBAAoB,CAAC,EACnB,GAAGD,iBADgB;AAEnBgD,MAAAA,aAAa,EAAED;AAFI,KAAD,CAApB;AAID,GAfD;;AAgBA,QAAME,uBAAuB,GAAIjB,CAAD,IAAO;AACrC,UAAMkB,qBAAqB,GAAGlB,CAAC,CAACP,GAAF,CAAOC,OAAD,IAAa;AAC/C,aAAOA,OAAO,CAAChB,KAAf;AACD,KAF6B,CAA9B;AAGA,UAAMyC,qBAAqB,GAAGnB,CAAC,CAACP,GAAF,CAAOC,OAAD,IAAa;AAC/C,aAAOA,OAAO,CAACjB,KAAf;AACD,KAF6B,CAA9B;AAGAV,IAAAA,oBAAoB,CAAC,EACnB,GAAGD,iBADgB;AAEnBsD,MAAAA,kBAAkB,EAAEF;AAFD,KAAD,CAApB;AAIAjD,IAAAA,oBAAoB,CAAC,EACnB,GAAGD,iBADgB;AAEnBoD,MAAAA,kBAAkB,EAAED;AAFD,KAAD,CAApB;AAID,GAfD;;AAgBA,QAAME,uBAAuB,GAAIrB,CAAD,IAAO;AACrC,UAAMsB,qBAAqB,GAAGtB,CAAC,CAACP,GAAF,CAAOC,OAAD,IAAa;AAC/C,aAAOA,OAAO,CAAChB,KAAf;AACD,KAF6B,CAA9B;AAGA,UAAM6C,qBAAqB,GAAGvB,CAAC,CAACP,GAAF,CAAOC,OAAD,IAAa;AAC/C,aAAOA,OAAO,CAACjB,KAAf;AACD,KAF6B,CAA9B;AAIAV,IAAAA,oBAAoB,CAAC,EACnB,GAAGD,iBADgB;AAEnB0D,MAAAA,kBAAkB,EAAEF;AAFD,KAAD,CAApB;AAIArD,IAAAA,oBAAoB,CAAC,EACnB,GAAGD,iBADgB;AAEnBwD,MAAAA,kBAAkB,EAAED;AAFD,KAAD,CAApB;AAID,GAhBD;;AAiBA,QAAME,aAAa,GAAIzB,CAAD,IAAO;AAC3B,UAAM0B,UAAU,GAAG1B,CAAC,CAAC2B,MAAF,CAASjD,KAA5B;AACA,UAAMkD,SAAS,GAAG,IAAIC,IAAJ,CAASH,UAAT,EAAqBI,WAArB,EAAlB;AACA/D,IAAAA,oBAAoB,CAAC,EAAE,GAAGD,iBAAL;AAAwBiE,MAAAA,SAAS,EAAEH;AAAnC,KAAD,CAApB;AACA3D,IAAAA,oBAAoB,CAAC,EAAE,GAAGD,iBAAL;AAAwB+D,MAAAA,SAAS,EAAEH;AAAnC,KAAD,CAApB;AACD,GALD;;AAMA,QAAMI,WAAW,GAAIhC,CAAD,IAAO;AACzB,UAAMiC,QAAQ,GAAGjC,CAAC,CAAC2B,MAAF,CAASjD,KAA1B;AACA,UAAMwD,OAAO,GAAG,IAAIL,IAAJ,CAASI,QAAT,EAAmBH,WAAnB,EAAhB;AACA/D,IAAAA,oBAAoB,CAAC,EAAE,GAAGD,iBAAL;AAAwBqE,MAAAA,OAAO,EAAED;AAAjC,KAAD,CAApB;AACAjE,IAAAA,oBAAoB,CAAC,EAAE,GAAGD,iBAAL;AAAwBmE,MAAAA,OAAO,EAAED;AAAjC,KAAD,CAApB;AACD,GALD,CAxKuB,CA+KvB;AACA;;;AACA,QAAM;AAAEE,IAAAA,IAAI,EAAEC;AAAR,MAAyBnF,QAAQ,CAAC,CAAC,mBAAD,CAAD,EAAwB,MAC7D0B,kBAAkB,CAAClB,KAAD,EAAQU,mBAAR,EAA6BN,iBAA7B,CADmB,CAAvC,CAjLuB,CAoLvB;AAEA;;AACA,QAAM;AAAEsE,IAAAA,IAAI,EAAEE;AAAR,MAAsB9E,eAAe,CACzC,CAAC,yBAAD,EAA4B,SAA5B,CADyC,EAEzC,MAAMJ,sBAAsB,CAACM,KAAD,CAFa,CAA3C,CAvLuB,CA4LvB;;AAEA,QAAM6E,wBAAwB,GAAGrF,QAAQ,CACvC,CAAC,6BAAD,CADuC,EAEvC,MACEG,sBAAsB,CAACK,KAAD,EAAQY,uBAAR,EAAiCR,iBAAjC,CAHe,CAAzC;AAMA,QAAM0E,8BAA8B,GAAGD,wBAAwB,CAACH,IAAhE,CApMuB,CAsMvB;;AACA,QAAMK,qBAAqB,GAAG,YAAY;AACxC,UAAMC,QAAQ,GAAGF,8BAA8B,CAACJ,IAA/B,CAAoC3C,GAApC,CAAyCC,OAAD,IAAa;AACpE,aAAO;AACLjB,QAAAA,KAAK,EAAEiB,OAAO,CAACE,IADV;AAELlB,QAAAA,KAAK,EAAEgB,OAAO,CAACC,EAFV;AAGLgD,QAAAA,QAAQ,EAAEjD,OAAO,CAACiD,QAHb;AAILC,QAAAA,sBAAsB,EAAElD,OAAO,CAACkD,sBAJ3B,CAKL;;AALK,OAAP;AAOD,KARgB,CAAjB;AAUAzE,IAAAA,mBAAmB,CAACuE,QAAD,CAAnB;AACD,GAZD,CAvMuB,CAqNvB;;;AACA,QAAMG,gBAAgB,GAAG3F,QAAQ,CAAC,CAAC,qBAAD,CAAD,EAA0B,MACzDI,mBAAmB,CAACI,KAAD,CADY,CAAjC;AAGA,QAAMoF,oBAAoB,GAAGD,gBAAgB,CAACT,IAA9C;AACA,QAAMW,qBAAqB,GAAGD,oBAAH,aAAGA,oBAAH,uBAAGA,oBAAoB,CAAEV,IAApD,CA1NuB,CA2NvB;;AACA,QAAMY,wBAAwB,GAAGD,qBAAH,aAAGA,qBAAH,uBAAGA,qBAAqB,CAAEE,UAAvB,CAAkCxD,GAAlC,CAC/B,CAACC,OAAD,EAAUwD,KAAV,MAAqB;AACnBxE,IAAAA,KAAK,EAAEgB,OAAO,CAACC,EADI;AAEnBlB,IAAAA,KAAK,EAAEiB,OAAO,CAACyD;AAFI,GAArB,CAD+B,CAAjC,CA5NuB,CAmOvB;;AACA,QAAMC,wBAAwB,GAAGL,qBAAH,aAAGA,qBAAH,uBAAGA,qBAAqB,CAAEM,SAAvB,CAAiC5D,GAAjC,CAC/B,CAACC,OAAD,EAAUwD,KAAV,KAAoB;AAClB,WAAO;AACL;AAEAxE,MAAAA,KAAK,EAAEgB,OAAO,CAACC,EAHV;AAILlB,MAAAA,KAAK,EAAEiB,OAAO,CAACyD;AAJV,KAAP;AAMD,GAR8B,CAAjC,CApOuB,CA8OvB;AACA;;AAEA,QAAMG,YAAY,GAAG,MAAM;AACzBC,IAAAA,OAAO,CAACC,GAAR,CAAY,mBAAZ,EAAiC1F,iBAAjC;AACAyF,IAAAA,OAAO,CAACC,GAAR,CAAY,qBAAZ,EAAmCxF,iBAAnC;AACD,GAHD,CAjPuB,CAsPvB;;;AAEAhB,EAAAA,SAAS,EACP;AACA,QAAM;AACJ4B,IAAAA,kBAAkB,CAAClB,KAAD,EAAQU,mBAAR,EAA6BN,iBAA7B,CAAlB;AACD,GAJM,EAKP,CAACA,iBAAD,EAAoBA,iBAApB,CALO,CAAT;AAOAd,EAAAA,SAAS,EACP;AACA,cAAY;AACVa,IAAAA,WAAW,CAAC+C,iBAAZ,CAA8B,mBAA9B;AACA4B,IAAAA,8BAA8B,KAAK,MAAMC,qBAAqB,EAAhC,CAA9B;AACD,GALM,EAMP,CAACD,8BAAD,EAAiCpE,mBAAjC,CANO,CAAT;AASA,SAAO;AACLI,IAAAA,iBADK;AAELsE,IAAAA,oBAFK;AAGLM,IAAAA,wBAHK;AAILJ,IAAAA,wBAJK;AAKLrE,IAAAA,eALK;AAML0D,IAAAA,YANK;AAOLC,IAAAA,SAPK;AAQLvC,IAAAA,kBARK;AASLG,IAAAA,eATK;AAULG,IAAAA,gBAVK;AAWLG,IAAAA,mBAXK;AAYLK,IAAAA,mBAZK;AAaLI,IAAAA,uBAbK;AAcLI,IAAAA,uBAdK;AAeLI,IAAAA,aAfK;AAgBLO,IAAAA,WAhBK;AAiBLsB,IAAAA,YAjBK;AAkBLpF,IAAAA;AAlBK,GAAP;AAoBD,CA5RD;;GAAMT,U;UAEgBR,c,EA+KWC,Q,EAMHM,e,EAOKN,Q,EAwBRA,Q;;;KAtNrBO,U;AA8RN,eAAeA,UAAf","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport { useQueryClient, useQuery } from \"react-query\";\r\nimport { getLocations } from \"../../APIS\";\r\nimport {\r\n  getreportLocationBrand,\r\n  // getreportLocations,\r\n  getResourcetypereports,\r\n} from \"../../APIS/reports\";\r\nimport { getUserByProfession } from \"../../APIS/userProfle\";\r\nimport { DIOM_BASED_URLS } from \"../../config/url\";\r\nimport { useAllDataQuery } from \"../../hooks/query\";\r\n\r\nconst UseReports = () => {\r\n  const token = localStorage.getItem(\"Token\");\r\n  const queryClient = useQueryClient();\r\n\r\n  const [reportFinalValues, setreportFinalValues] = useState({});\r\n  const [reportFinalLabels, setReportFinalLabels] = useState({});\r\n  const [categoryDropDown, setCategoryDropDown] = useState([]);\r\n  const [locationApplyFilter, setLocationApplyFilter] = useState(false);\r\n  const [resourcetypeApplyFilter, setResourcetypeApplyFilter] = useState(false);\r\n\r\n  const reportTypeOptions = [\r\n    { label: \"Booking Report\", value: 0 },\r\n    { label: \"User Report\", value: 1 },\r\n    { label: \"User Ananlysis Report\", value: 2 },\r\n    { label: \"Cancelled Bookings\", value: 3 },\r\n  ];\r\n  const timeSlotOptions = [\r\n    { label: \"08_AM-04_PM\", value: 0 },\r\n    { label: \"04_PM-12_AM\", value: 1 },\r\n    { label: \"12_AM-08_AM\", value: 2 },\r\n  ];\r\n\r\n  const getreportLocations = async (\r\n    token,\r\n    locationApplyFilter,\r\n    reportFinalValues,\r\n    locationInvalidatequerry\r\n  ) => {\r\n    // console.log(\"locationApplyFilter====>  \", locationApplyFilter);\r\n    // console.log(\r\n    //   \"reportFinalValues ====^^^ : \",\r\n    //   JSON.stringify(reportFinalValues?.diomBrand)\r\n    // );\r\n\r\n    const diomBrandValue = JSON.stringify(reportFinalValues?.diomBrand);\r\n\r\n    const res = (\r\n      await (\r\n        await fetch(\r\n          !locationApplyFilter || diomBrandValue == []\r\n            ? `${DIOM_BASED_URLS}/admin-business-locations?filter={\"where\":{\"visibility\":true}}`\r\n            : `${DIOM_BASED_URLS}/admin-business-locations?filter={\"where\":{\"locationCategoriesId\":{\"inq\":${diomBrandValue}}}}`,\r\n          {\r\n            method: \"GET\",\r\n            redirect: \"follow\",\r\n            headers: {\r\n              Authorization: \"Bearer \" + token,\r\n            },\r\n          }\r\n        )\r\n      ).json()\r\n    ).map((element) => ({\r\n      value: element.id,\r\n      label: element.Name,\r\n    }));\r\n    return [\r\n      {\r\n        label: \"--All Locations\",\r\n        options: [...res],\r\n      },\r\n    ];\r\n    queryClient.setQueryData(\"locationsreports1\");\r\n  };\r\n\r\n  const reportTypeHandeler = (e) => {\r\n    // console.log(\"reportTypeHandeler : \", e);\r\n    setreportFinalValues({ ...reportFinalValues, reportType: e });\r\n    setReportFinalLabels({ ...reportFinalLabels, reportType: e });\r\n  };\r\n  const timeSlotHandler = (e) => {\r\n    const timeSlotLabel = e.map((element) => {\r\n      return element.label;\r\n    });\r\n    // const timeSlotValue = e.map((element) => {\r\n    //   return element.value;\r\n    // });\r\n    setreportFinalValues({ ...reportFinalValues, timeSlot: timeSlotLabel });\r\n    setReportFinalLabels({ ...reportFinalLabels, timeSlot: timeSlotLabel });\r\n  };\r\n  const diomBrandHandler = async (e) => {\r\n    // console.log(\"reportFinalValues?.diomBrand :\", reportFinalValues?.diomBrand);\r\n\r\n    const brandValue = e.map((element) => {\r\n      return element.value;\r\n    });\r\n    const brandLabel = e.map((element) => {\r\n      return element.label;\r\n    });\r\n\r\n    setreportFinalValues({ ...reportFinalValues, diomBrand: brandValue });\r\n    setReportFinalLabels({ ...reportFinalLabels, diomBrand: brandLabel });\r\n    setLocationApplyFilter(true);\r\n\r\n    // await queryClient.setQueryData(\"locationsreports1\");\r\n  };\r\n  const diomLocationHandler = (e) => {\r\n    const locationValue = e.map((element) => {\r\n      return element.value;\r\n    });\r\n    const locationLabel = e.map((element) => {\r\n      return element.label;\r\n    });\r\n    setreportFinalValues({\r\n      ...reportFinalValues,\r\n      diomLocations: locationValue,\r\n    });\r\n    setReportFinalLabels({\r\n      ...reportFinalLabels,\r\n      diomLocations: locationLabel,\r\n    });\r\n    setResourcetypeApplyFilter(true);\r\n    queryClient.invalidateQueries(\"resourceTypedropdownreports\");\r\n  };\r\n  const resourceTypeHandler = (e) => {\r\n    const resourceTypeValue = e.map((element) => {\r\n      return element.value;\r\n    });\r\n    const resourceTypeLabel = e.map((element) => {\r\n      return element.label;\r\n    });\r\n    setreportFinalValues({\r\n      ...reportFinalValues,\r\n      resourceTypes: resourceTypeValue,\r\n    });\r\n    setReportFinalLabels({\r\n      ...reportFinalLabels,\r\n      resourceTypes: resourceTypeLabel,\r\n    });\r\n  };\r\n  const userTypeIndustryHandler = (e) => {\r\n    const userTypeIndustryValue = e.map((element) => {\r\n      return element.value;\r\n    });\r\n    const userTypeIndustryLabel = e.map((element) => {\r\n      return element.label;\r\n    });\r\n    setreportFinalValues({\r\n      ...reportFinalValues,\r\n      userTypeByIndustry: userTypeIndustryValue,\r\n    });\r\n    setReportFinalLabels({\r\n      ...reportFinalLabels,\r\n      userTypeByIndustry: userTypeIndustryLabel,\r\n    });\r\n  };\r\n  const userTypePositionHandler = (e) => {\r\n    const userTypePositionValue = e.map((element) => {\r\n      return element.value;\r\n    });\r\n    const userTypePositionLabel = e.map((element) => {\r\n      return element.label;\r\n    });\r\n\r\n    setreportFinalValues({\r\n      ...reportFinalValues,\r\n      userTypeByPosition: userTypePositionValue,\r\n    });\r\n    setReportFinalLabels({\r\n      ...reportFinalLabels,\r\n      userTypeByPosition: userTypePositionLabel,\r\n    });\r\n  };\r\n  const startdateFunc = (e) => {\r\n    const starttdate = e.target.value;\r\n    const startdate = new Date(starttdate).toISOString();\r\n    setreportFinalValues({ ...reportFinalValues, startDate: startdate });\r\n    setReportFinalLabels({ ...reportFinalLabels, startDate: startdate });\r\n  };\r\n  const endDateFunc = (e) => {\r\n    const endddate = e.target.value;\r\n    const enddate = new Date(endddate).toISOString();\r\n    setreportFinalValues({ ...reportFinalValues, endDate: enddate });\r\n    setReportFinalLabels({ ...reportFinalLabels, endDate: enddate });\r\n  };\r\n\r\n  // ***************\r\n  // const { data: locationsData, isLoading: loadingLocations } = useAllDataQuery(\r\n  const { data: locationData } = useQuery([\"locationsreports1\"], () =>\r\n    getreportLocations(token, locationApplyFilter, reportFinalValues)\r\n  );\r\n  // const locationData = locationsData;\r\n\r\n  // *******************\r\n  const { data: brandData } = useAllDataQuery(\r\n    [\"reportlocationbrandData\", \"visible\"],\r\n    () => getreportLocationBrand(token)\r\n  );\r\n\r\n  // *************\r\n\r\n  const resourceTypedropdownData = useQuery(\r\n    [\"resourceTypedropdownreports\"],\r\n    () =>\r\n      getResourcetypereports(token, resourcetypeApplyFilter, reportFinalValues)\r\n  );\r\n\r\n  const resourceTypedropdownDailedData = resourceTypedropdownData.data;\r\n\r\n  // *************\r\n  const Resourcetypesdropdown = async () => {\r\n    const matadata = resourceTypedropdownDailedData.data.map((element) => {\r\n      return {\r\n        label: element.Name,\r\n        value: element.id,\r\n        UniqueId: element.UniqueId,\r\n        resourceTypeCategoryId: element.resourceTypeCategoryId,\r\n        // visibility: element.visibility,\r\n      };\r\n    });\r\n\r\n    setCategoryDropDown(matadata);\r\n  };\r\n\r\n  // **************\r\n  const userByProfession = useQuery([\"getuserbyprofession\"], () =>\r\n    getUserByProfession(token)\r\n  );\r\n  const userByProfessionData = userByProfession.data;\r\n  const userByProfessionDataa = userByProfessionData?.data;\r\n  // console.log(\"userByProfessionData \", userByProfessionDataa);\r\n  const userbyprofessionindustry = userByProfessionDataa?.industries.map(\r\n    (element, index) => ({\r\n      value: element.id,\r\n      label: element.name,\r\n    })\r\n  );\r\n\r\n  // console.log(\"userbyprofessionindustry \", userbyprofessionindustry);\r\n  const userbyprofessionPosition = userByProfessionDataa?.positions.map(\r\n    (element, index) => {\r\n      return {\r\n        //   ...element,\r\n\r\n        value: element.id,\r\n        label: element.name,\r\n      };\r\n    }\r\n  );\r\n  // console.log(\"userbyprofessionPosition \", userbyprofessionPosition);\r\n  // *************\r\n\r\n  const reportExport = () => {\r\n    console.log(\"reportFinalIDs : \", reportFinalValues);\r\n    console.log(\"reportFinalLabels: \", reportFinalLabels);\r\n  };\r\n\r\n  // console.log(\"locationApplyFilter :\", locationApplyFilter);\r\n\r\n  useEffect(\r\n    // FOR PRE-FETCHING NEXT PAGE\r\n    () => {\r\n      getreportLocations(token, locationApplyFilter, reportFinalValues);\r\n    },\r\n    [reportFinalValues, reportFinalValues]\r\n  );\r\n  useEffect(\r\n    // FOR PRE-FETCHING NEXT PAGE\r\n    async () => {\r\n      queryClient.invalidateQueries(\"locationsreports1\");\r\n      resourceTypedropdownDailedData && (await Resourcetypesdropdown());\r\n    },\r\n    [resourceTypedropdownDailedData, locationApplyFilter]\r\n  );\r\n\r\n  return {\r\n    reportTypeOptions,\r\n    userByProfessionData,\r\n    userbyprofessionPosition,\r\n    userbyprofessionindustry,\r\n    timeSlotOptions,\r\n    locationData,\r\n    brandData,\r\n    reportTypeHandeler,\r\n    timeSlotHandler,\r\n    diomBrandHandler,\r\n    diomLocationHandler,\r\n    resourceTypeHandler,\r\n    userTypeIndustryHandler,\r\n    userTypePositionHandler,\r\n    startdateFunc,\r\n    endDateFunc,\r\n    reportExport,\r\n    categoryDropDown,\r\n  };\r\n};\r\n\r\nexport default UseReports;\r\n"]},"metadata":{},"sourceType":"module"}